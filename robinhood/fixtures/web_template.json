[
 {
  "docstatus": 0,
  "doctype": "Web Template",
  "fields": [],
  "modified": "2021-12-28 10:44:02.720705",
  "module": "Robinhood",
  "name": "top-cities",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "standard": 0,
  "template": "{% set cities = frappe.db.sql(\"\"\" select sum(c.meals_served) as meals_served, cp.city from `tabCheckin` as c INNER JOIN `tabRobin Chapter Mapping` as r on c.chapter = r.name  inner join `tabChapter` as cp on r.chapter = cp.name  group by cp.city\"\"\", as_dict=True) %}\n<div>\n <h2>Top cities</h2>\n    <div class=\"dheight\">\n        The Robin Hood Army is a volunteer-based Zero funds organization that works to get surplus food from restaurants\n    </div>\n</div>\n<div class=\"row dheight\">\n    {% for city in cities %}\n    <div class=\"col-md-6\">\n        <div class=\"row dheight\">\n            <div class=\"col-md-3\">\n                <a href = '/city/{{ city.city }}'>{{ loop.index }}. {{ city.city }}</a>\n            </div>\n            <div class=\"col-md-9\">\n                <div style='background-color:green;width:70%;height: 5px;border-radius: 3px;'></div>\n                <div>{{ frappe.format(city.meals_served) }}</div>\n            </div>\n        </div>\n    </div>\n    {% endfor %}\n</div>",
  "type": "Section"
 },
 {
  "docstatus": 0,
  "doctype": "Web Template",
  "fields": [],
  "modified": "2021-12-30 14:30:14.326166",
  "module": "Robinhood",
  "name": "checkins-chart",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "standard": 0,
  "template": "<h2>Checkin trend</h2>\n\n<div id=\"chart\"></div>\n<script type=\"text/javascript\">\n    var city = ''\n    if (window.location.pathname.includes('city')) {\n        city = window.location.pathname.split('/')[2]\n    }\n\n    frappe.call({\n        method: \"robinhood.robinhood.doctype.checkin.checkin.checkins\",\n        freeze: true,\n        type: 'get',\n        args: {\n            \"city\": city\n        },\n        callback: function(r) {\n            if (r) {\n                const data = {\n                    labels: r.message['labels'],\n                    datasets: [{\n                        name: \"Checkins\",\n                        type: \"bar\",\n                        values: r.message['values']\n                    }, ]\n                }\n\n                const chart = new Chart.Chart(\"#chart\", { // or a DOM element,\n                    // new Chart() in case of ES6 module with above usage\n                    title: \"Checkins for last 30days\",\n                    data: data,\n                    type: 'bar', // or 'bar', 'line', 'scatter', 'pie', 'percentage'\n                    height: 250,\n                    colors: ['#0B622E', '#0B622E']\n                })\n            }\n        }\n    });\n    </script>",
  "type": "Section"
 },
 {
  "docstatus": 0,
  "doctype": "Web Template",
  "fields": [],
  "modified": "2021-12-30 14:49:23.606878",
  "module": "Robinhood",
  "name": "top-robins",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "standard": 0,
  "template": "\n{% set args = frappe.form_dict %}\n{% if args %}\n    {% set checkins = frappe.db.sql(\"\"\" SELECT c.name, c.selfie, c.creation, c.owner, cp.city as chapter, sum(c.meals_served) as meals_served from `tabCheckin` c  INNER JOIN `tabRobin Chapter Mapping` as r ON c.chapter = r.name INNER JOIN `tabChapter` as cp ON r.chapter = cp.name WHERE  cp.city = %(city)s group by c.owner, c.name, cp.city order by meals_served limit 10\"\"\", args, as_dict=True    ) %}\n{% else %}\n    {%   set checkins = frappe.db.sql(\"\"\" SELECT c.name, c.selfie, c.creation, c.owner, cp.city as chapter, sum(c.meals_served) as meals_served from `tabCheckin` c  INNER JOIN `tabRobin Chapter Mapping` as r ON c.chapter = r.name INNER JOIN `tabChapter` as cp ON r.chapter = cp.name group by c.owner, c.name, cp.city order by meals_served  limit 10\"\"\", as_dict=True)%}\n{% endif %}\n\n\n<h2>Top Robins</h2>\n    <div>The Robin Hood Army is a volunteer-based Zero funds organization that works to get surplus food from restaurants to the less fortunate sections of society in cities across India and 14 other countries</div>\n\n<table>\n        <tr class='table-row'>\n            <th class='table-header'></th>\n            <th class='table-header'>Name</th>\n            <th class='table-header'>Chapter</th>\n            <th class='table-header'>Drives</th>\n        </tr>\n        {% for checkin in checkins %}\n        \n            <tr class='table-row'>\n                <td class='text-center'><span><img src={{checkin.selfie}} alt=\"Italian Trulli\"> </span></td>\n                <td class='border-bottom'>{{ checkin.owner }}</td>\n                <td class='border-bottom'> <a href = '/city/{{ checkin.chapter }}'>{{ checkin.chapter }}</a> </td>\n                <td class='border-bottom'>{{ checkin.meals_served }}</td>\n            </tr>\n        {% endfor %}\n    </table>\n    ",
  "type": "Section"
 },
 {
  "docstatus": 0,
  "doctype": "Web Template",
  "fields": [],
  "modified": "2021-12-06 12:28:13.883000",
  "module": "Robinhood",
  "name": "Home",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "standard": 0,
  "template": "<div>\n    The Robin Hood Army is a volunteer-based Zero funds organization that works to get surplus food from restaurants to the less fortunate sections of society in cities across India and 14 other countries. \n    <a href=\"https://en.wikipedia.org/wiki/Robin_Hood_Army\">Wikipedia</a>\n</div>",
  "type": "Section"
 },
 {
  "docstatus": 0,
  "doctype": "Web Template",
  "fields": [],
  "modified": "2021-11-30 08:32:19.685484",
  "module": "Robinhood",
  "name": "Heat-Map",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "standard": 1,
  "template": "",
  "type": "Section"
 },
 {
  "docstatus": 0,
  "doctype": "Web Template",
  "fields": [],
  "modified": "2021-12-30 14:01:01.656973",
  "module": "Robinhood",
  "name": "city",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "standard": 0,
  "template": "{% set args = frappe.form_dict %}\n{% set city = frappe.db.sql(\"\"\" SELECT name, state from `tabCity` where name = %(city)s \"\"\", args, as_dict=True) %}\n{% set total_drives = frappe.db.sql(\"\"\" select sum(c.meals_served) as meals_served from `tabCheckin` as c INNER JOIN `tabRobin Chapter Mapping` as r on c.chapter = r.name  inner join `tabChapter` as cp on r.chapter = cp.name  where cp.city = %(city)s \"\"\", args, as_dict=True) %}\n{% set total_chapters = frappe.db.sql(\"\"\" select count(name) as chapters from `tabChapter` where city = %(city)s \"\"\", args, as_dict=True) %}\n{% set total_robins = frappe.db.sql(\"\"\" SELECT count(distinct r.user) as robins from `tabRobin Chapter Mapping` as r inner join `tabChapter` as c on r.chapter = c.name where c.city = %(city)s group by c.name \"\"\", args, as_dict=True)%}\n<div>\n    {% if city %}\n    <h2>\n        \n{{ city[0].name }}</h2>\n    {{ city[0].state }}\n{% else %}\n    Invalid City Name\n{% endif %}\n</div>\n<hr>\n\n<div class=\"row\">\n    <div class=\"col-md-2\">\n        Ranking\n    </div>\n    <div class=\"col-md-2\">\n        Total drives\n    </div>\n    <div class=\"col-md-2\">\n        Chapters\n    </div>\n    <div class=\"col-md-2\">\n        Robins\n    </div>\n    <div class=\"col-md-2\">\n        Average drives\n    </div>\n</div>\n\n<div class=\"row\">\n    <div class=\"col-md-2\">\n        1\n    </div>\n    <div class=\"col-md-2\">\n        {% if total_drives %}\n            {{ frappe.format(total_drives[0].meals_served) }}\n        {% else %}\n            0\n        {% endif %}\n    </div>\n    <div class=\"col-md-2\">\n        {% if total_chapters %}\n            {{ frappe.format(total_chapters[0].chapters)}}\n        {% else %}\n            0\n        {% endif %}\n    </div>\n     <div class=\"col-md-2\">\n        {% if total_robins %}\n            {{frappe.format(total_robins[0].robins) }}\n        {% else %}\n            0\n        {% endif %}\n    </div>\n    <div class=\"col-md-2\">\n        356/week\n    </div>\n</div>\n\n<hr>\n<script>document.title = \"{{ city[0].name }} - \" + document.title;</script>",
  "type": "Section"
 },
 {
  "docstatus": 0,
  "doctype": "Web Template",
  "fields": [],
  "modified": "2021-12-28 10:45:53.582389",
  "module": "Robinhood",
  "name": "top-chapters",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "standard": 0,
  "template": "{% set args = frappe.form_dict %}\n{% if args %}\n    {% set chapters = frappe.db.sql(\"\"\"select sum(c.meals_served) as meals_served, r.chapter from `tabCheckin` as c INNER JOIN `tabRobin Chapter Mapping` as r on c.chapter = r.name  inner join `tabChapter` as cp on r.chapter = cp.name  where cp.city = %(city)s group by r.chapter\"\"\", args, as_dict=True    ) %}\n{% else %}\n    {%   set chapters = frappe.db.sql(\"\"\" select sum(c.meals_served) as meals_served, r.chapter from `tabCheckin` as c INNER JOIN `tabRobin Chapter Mapping` as r on c.chapter = r.name group by r.chapter\"\"\", as_dict=True) %}\n{% endif %}\n<div>\n    <h2>Top chapters</h2>\n    <div class=\"dheight\">\n        The Robin Hood Army is a volunteer-based Zero funds organization that works to get surplus food from restaurants\n    </div>\n</div>\n<div class=\"row dheight\">\n    {% for chapter in chapters %}\n    <div class=\"col-md-6\">\n        <div class=\"row dheight\">\n            <div class=\"col-md-3\">\n                {{ loop.index }}. {{ chapter.chapter}}\n            </div>\n            <div class=\"col-md-9\">\n                <div style='background-color:green;width:70%;height: 5px;border-radius: 3px;'></div>\n                <div>{{ frappe.format(chapter.meals_served) }}</div>\n            </div>\n        </div>\n    </div>\n   \n    {% endfor %}\n    \n</div>",
  "type": "Section"
 }
]