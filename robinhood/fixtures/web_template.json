[
 {
  "docstatus": 0,
  "doctype": "Web Template",
  "fields": [],
  "modified": "2022-02-19 17:29:41.486270",
  "module": "Robinhood",
  "name": "all-cities",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "standard": 0,
  "template": "{% set cities = frappe.db.sql(\"\"\"SELECT c.name FROM `tabCity` as c order by c.name\"\"\", as_dict=True)%}\n<div class='row city' style=\"margin-bottom: 4rem;\">\n    <div class=\"col-md-3\">\n    \n<label for=\"city\">Choose a city:</label>\n\n<select name=\"city\" id=\"city\" class=\"form-control\">\n    <option></option>\n    {% for city in cities %}\n   <option value=\"{{city.name}}\">{{city.name}}</option>\n   {% endfor %}\n</select>\n    \n</div>\n\n</div>",
  "type": "Section"
 },
 {
  "docstatus": 0,
  "doctype": "Web Template",
  "fields": [],
  "modified": "2022-02-03 19:47:01.588389",
  "module": "Robinhood",
  "name": "Heat-Map",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "standard": 1,
  "template": "",
  "type": "Section"
 },
 {
  "docstatus": 0,
  "doctype": "Web Template",
  "fields": [],
  "modified": "2022-02-14 11:59:05.681097",
  "module": "Robinhood",
  "name": "checkins-chart",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "standard": 0,
  "template": "<h2>CheckIn trend</h2>\n\n<div id=\"chart\"></div>\n<script type=\"text/javascript\">\n    var city = ''\n    if (window.location.pathname.includes('city')) {\n        city = window.location.pathname.split('/')[2]\n    }\n\n    frappe.call({\n        method: \"robinhood.robinhood.doctype.checkin.checkin.checkins\",\n        freeze: true,\n        type: 'get',\n        args: {\n            \"city\": city\n        },\n        callback: function(r) {\n            if (r) {\n                const data = {\n                    labels: r.message['labels'],\n                    datasets: [{\n                        name: \"CheckIns\",\n                        type: \"bar\",\n                        values: r.message['values']\n                    }, ]\n                }\n\n                const chart = new Chart.Chart(\"#chart\", { // or a DOM element,\n                    // new Chart() in case of ES6 module with above usage\n                    title: \"CheckIns in the last 60 days\",\n                    data: data,\n                    type: 'bar', // or 'bar', 'line', 'scatter', 'pie', 'percentage'\n                    height: 250,\n                    colors: ['#0B622E', '#0B622E']\n                })\n            }\n        }\n    });\n    </script>",
  "type": "Section"
 },
 {
  "docstatus": 0,
  "doctype": "Web Template",
  "fields": [],
  "modified": "2021-12-06 12:28:13.883000",
  "module": "Robinhood",
  "name": "Home",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "standard": 0,
  "template": "<div>\n    The Robin Hood Army is a volunteer-based Zero funds organization that works to get surplus food from restaurants to the less fortunate sections of society in cities across India and 14 other countries. \n    <a href=\"https://en.wikipedia.org/wiki/Robin_Hood_Army\">Wikipedia</a>\n</div>",
  "type": "Section"
 },
 {
  "docstatus": 0,
  "doctype": "Web Template",
  "fields": [],
  "modified": "2022-02-03 17:31:36.528225",
  "module": "Robinhood",
  "name": "top-chapters",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "standard": 0,
  "template": "{% set args = frappe.form_dict %}\n{% if args %}\n    {% set chapters = frappe.db.sql(\"\"\"select count(*) as checkin_count, r.chapter from `tabCheckin` as c INNER JOIN `tabRobin Chapter Mapping` as r on c.chapter = r.name  inner join `tabChapter` as cp on r.chapter = cp.name  where cp.city = %(city)s group by r.chapter\"\"\", args, as_dict=True    ) %}\n{% else %}\n    {%   set chapters = frappe.db.sql(\"\"\" select count(*) as checkin_count, r.chapter from `tabCheckin` as c INNER JOIN `tabRobin Chapter Mapping` as r on c.chapter = r.name group by r.chapter\"\"\", as_dict=True) %}\n{% endif %}\n<div>\n    <h2>Top chapters</h2>\n    <div class=\"dheight\">\n        The Robin Hood Army is a volunteer-based Zero funds organization that works to get surplus food from restaurants\n    </div>\n</div>\n<div class=\"row dheight\">\n    {% for chapter in chapters %}\n    <div class=\"col-md-6\">\n        <div class=\"row dheight\">\n            <div class=\"col-md-3\">\n                {{ loop.index }}. {{ chapter.chapter}}\n            </div>\n            <div class=\"col-md-9\">\n                <div style='background-color:green;width:70%;height: 5px;border-radius: 3px;'></div>\n                <div>{{ frappe.format(chapter.checkin_count) }}</div>\n            </div>\n        </div>\n    </div>\n   \n    {% endfor %}\n    \n</div>",
  "type": "Section"
 },
 {
  "docstatus": 0,
  "doctype": "Web Template",
  "fields": [],
  "modified": "2022-03-01 10:48:05.452413",
  "module": "Robinhood",
  "name": "top-cities",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "standard": 0,
  "template": "{% set cities = frappe.db.sql(\"\"\" select count(c.name) as drives, c.city from `tabCheckin` as c group by c.city order by drives desc\"\"\", as_dict=True) %}\n<div>\n <h2>Top Active Cities</h2>\n    <div class=\"dheight\">\n        No. of checkIns across the cities in the last 60 days.\n    </div>\n</div>\n<div class=\"row dheight\">\n    {% for city in cities %}\n    <div class=\"col-md-6\">\n        <div class=\"row dheight\">\n            <div class=\"col-md-3\">\n                <a href = '/city/{{ city.city }}'>{{ loop.index }}. {{ city.city }}</a>\n            </div>\n            <div class=\"col-md-9\">\n                <div style='background-color:green;width:{{(city.drives/1000) * 100}}%;height: 5px;border-radius: 3px;max-width: 100%;'></div>\n                <div>{{ frappe.format(city.drives) }}</div>\n            </div>\n        </div>\n    </div>\n    {% endfor %}\n</div>\n\n",
  "type": "Section"
 },
 {
  "docstatus": 0,
  "doctype": "Web Template",
  "fields": [],
  "modified": "2022-04-05 12:04:38.739366",
  "module": "Robinhood",
  "name": "top-robins",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "standard": 0,
  "template": "\n{% set args = frappe.form_dict %}\n{% if args %}\n    {% set checkins = frappe.db.sql(\"\"\"SELECT c.name, ifnull(up.user_image, '/assets/robinhood/images/robinhood_alt.png') as profile_thumbnail, c.creation, up.first_name as owner, c.city as chapter, count(*) as checkin_count from `tabCheckin` c  inner join `tabUser` as up on c.owner = up.name WHERE  c.city = %(city)s group by c.owner order by checkin_count desc limit 10\"\"\", args, as_dict=True    ) %}\n{% else %}\n    {%   set checkins = frappe.db.sql(\"\"\"SELECT c.name, ifnull(up.user_image, '/assets/robinhood/images/robinhood_alt.png') as profile_thumbnail, c.creation, up.first_name as owner, c.city as chapter, count(*) as checkin_count from `tabCheckin` c inner join `tabUser` as up on c.owner = up.name group by c.owner, c.city order by checkin_count desc limit 10\"\"\", as_dict=True)%}\n{% endif %}\n\n\n<h2>Top Active Robins</h2>\n    <div>Robins with the highest checked in drives in the last 60 days.</div>\n\n<table>\n        <tr>\n            <th class='table-header'></th>\n            <th class='table-header'>Name</th>\n            <th class='table-header'>Chapter</th>\n            <th class='table-header'>Drives</th>\n        </tr>\n        {% for checkin in checkins %}\n        \n            <tr>\n                <td class='text-center'><span><img src={{checkin.profile_thumbnail}} width='90px' height='90px' style=\"border-radius: 50%;object-fit:cover;\"> </span></td>\n                <td class='border-bottom'>{{ checkin.owner.title() }}</td>\n                <td class='border-bottom'> <a href = '/city/{{ checkin.chapter }}'>{{ checkin.chapter }}</a> </td>\n                <td class='border-bottom'>{{ frappe.format(checkin.checkin_count) }}</td>\n            </tr>\n        {% endfor %}\n    </table>\n    ",
  "type": "Section"
 },
 {
  "docstatus": 0,
  "doctype": "Web Template",
  "fields": [],
  "modified": "2022-04-04 20:46:18.188106",
  "module": "Robinhood",
  "name": "city",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "standard": 0,
  "template": "{% set args = frappe.form_dict %}\n{% set city = frappe.db.sql(\"\"\" SELECT name, state from `tabCity` where name = %(city)s \"\"\", args, as_dict=True) %}\n{% set total_checkins = frappe.db.sql(\"\"\" select count(c.name) as checkins from `tabCheckin` as c where c.city = %(city)s \"\"\", args, as_dict=True) %} \n{% set total_drives = frappe.db.sql(\"\"\" select  count(*) as checkin_count from `tabCheckin` where city = %(city)s \"\"\", args, as_dict=True) %}\n{% set total_chapters = frappe.db.sql(\"\"\" select count(name) as chapters from `tabChapter` where city = %(city)s \"\"\", args, as_dict=True) %}\n{% set total_robins = frappe.db.sql(\"\"\" SELECT count(distinct r.user) as robins from `tabRobin Chapter Mapping` as r inner join `tabChapter` as c on r.chapter = c.name where c.city = %(city)s group by c.name \"\"\", args, as_dict=True)%}\n{% set week_avg = frappe.db.sql(\"\"\" SELECT ROUND(AVG(checkins),0) as average FROM      (SELECT COUNT(name) AS checkins FROM `tabCheckin`where city = %(city)s    GROUP BY week(creation)) AS avg_checkins  \"\"\", args, as_dict=True) %}\n<div>\n    {% if city %}\n    <h2>\n        \n{{ city[0].name }}</h2>\n    {{ city[0].state }}\n{% else %}\n    Invalid City Name\n{% endif %}\n</div>\n<hr>\n\n<div class=\"row table-header\">\n    <div class=\"col-md-3\">\n        All time checkIns\n    </div>\n    <div class=\"col-md-3\">\n        Recent checkIns\n    </div>\n    <div class=\"col-md-3\">\n        Robins\n    </div>\n    <div class=\"col-md-3\">\n        Average checkIns\n    </div>\n</div>\n\n<div class=\"row table-row\">\n    <div class=\"col-md-3\">\n        {{total_checkins[0].checkins}}\n    </div>\n    <div class=\"col-md-3\">\n        {% if total_drives %}\n            {{ frappe.format(total_drives[0].checkin_count) }}\n        {% else %}\n            0\n        {% endif %}\n    </div>\n     <div class=\"col-md-3\">\n        {% if total_robins %}\n            {{frappe.format(total_robins[0].robins) }}\n        {% else %}\n            0\n        {% endif %}\n    </div>\n    <div class=\"col-md-3\">\n        {{ frappe.format(week_avg[0].average) }} / week\n    </div>\n</div>\n\n<hr>\n<script>document.title = \"{{ city[0].name }} - \" + document.title;</script>",
  "type": "Section"
 },
 {
  "docstatus": 0,
  "doctype": "Web Template",
  "fields": [],
  "modified": "2022-04-05 18:27:30.056356",
  "module": "Robinhood",
  "name": "Gallery",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "standard": 0,
  "template": "{% set args = frappe.form_dict %}\n{% if args %}\n    {% set images = frappe.db.sql(\"\"\"SELECT u.first_name, c.selfie_thumbnail, c.creation, date(c.creation) as posting_date from `tabCheckin` c JOIN `tabUser` u on c.owner=u.name  WHERE  c.city = %(city)s and c.selfie_thumbnail is not null order by creation desc limit 10;\"\"\", args, as_dict=True) %}\n{% else %}\n    {%   set images = frappe.db.sql(\"\"\"SELECT u.first_name, c.selfie_thumbnail, c.creation, date(c.creation) as posting_date, c.city from `tabCheckin` c JOIN `tabUser` u on c.owner=u.name  WHERE  c.selfie_thumbnail is not null order by creation desc limit 10;\"\"\", as_dict=True)%}\n{% endif %}\n\n<script>\n    \n    \n</script>\n\n\n<h2>Recent checkIns</h2>\n<div style=\"display: flex;flex-direction:row;\">\n<div class=\"row\">\n{% for image in images %}\n{% set image_link =  image.selfie_thumbnail.replace(\"-small\",\"\") %}\n\n   <div class=\"col-sm-3 col-md-2\">\n        <a href={{ image_link }} class=\"thumbnail\"><img src={{ image.selfie_thumbnail }} style=\"width:100px;height:100px;object-fit: cover; margin-right:5px\"/>\n        <p>{{image.first_name | title }}</p>\n      <span>{{image.city | title }}</span>\n      <p style=\"color: grey; font-size:12px\">{{image.posting_date}}</p></a>\n      </div>\n{% endfor %}\n\n\n</div>\n</div>\n\n",
  "type": "Section"
 }
]